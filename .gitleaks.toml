# GitLeaks configuration for SoulMatting project
# Version: 1.0.0
# Created: 2025-01-24
# Last Updated: 2025-01-24
# Author: Kim Hsiao

title = "GitLeaks config for SoulMatting"

[extend]
# Extend default rules
path = "https://raw.githubusercontent.com/gitleaks/gitleaks/master/config/gitleaks.toml"

# Custom rules for this project
[[rules]]
id = "soulmatting-api-key"
description = "SoulMatting API Key"
regex = '''(?i)(soulmatting[_-]?api[_-]?key)[\s]*[=:][\s]*["']?([a-zA-Z0-9]{32,})["']?'''
secretGroup = 2

[[rules]]
id = "database-connection-string"
description = "Database connection string"
regex = '''(?i)(database[_-]?url|db[_-]?url|connection[_-]?string)[\s]*[=:][\s]*["']?(postgresql://|mysql://|mongodb://)[^\s"']+["']?'''
secretGroup = 2

# Allowlist for false positives
[allowlist]
paths = [
  "\\.env\\.example$",
  "\\.\\(md|txt|rst\\)$",
  "(package-lock\\.json|yarn\\.lock|pnpm-lock\\.yaml)$"
]
regexes = [
  "(test|spec|example|mock|fixture)",
  "(your[_-]?secret[_-]?here|placeholder|example[_-]?key|dummy[_-]?token)"
]